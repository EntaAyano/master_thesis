from __future__ import division, print_function
import numpy as np
import matplotlib as mpl
import matplotlib.pyplot as plt
import skfuzzy as fuzz
from skfuzzy import control as ctrl
from decimal import Decimal, ROUND_HALF_UP, ROUND_HALF_EVEN
import random
from sklearn import linear_model, metrics, preprocessing, model_selection
from sklearn import svm
import time
import csv
import pandas as pd


#ファジィモデル
def make_fuzzy_model(input1,input2,input3,input4,c_p,c_s,p_a,p_an):
    action_num = []
    #print("a1")
    cart_speed = ctrl.Antecedent(np.arange(-2.00, 2.00, 0.01), 'cart_speed')
    pole_angular_velocity = ctrl.Antecedent(np.arange(-2.00, 2.00, 0.01), 'pole_angular_velocity')
    cart_position = ctrl.Antecedent(np.arange(-2.00, 2.00, 0.01), 'cart_position')
    pole_angule = ctrl.Antecedent(np.arange(-2.00, 2.00, 0.01), 'pole_angule')
    action = ctrl.Consequent(np.arange(0, 41, 1), 'action')

    #入力1のメンバーシップ関数
    cart_speed['0'] = fuzz.trapmf(cart_speed.universe, [input1[0][0],input1[0][1],input1[0][2],input1[0][3]])
    cart_speed['1'] = fuzz.trapmf(cart_speed.universe, [input1[1][0],input1[1][1],input1[1][2],input1[1][3]])
    cart_speed['2'] = fuzz.trapmf(cart_speed.universe, [input1[2][0],input1[2][1],input1[2][2],input1[2][3]])
    cart_speed['3'] = fuzz.trapmf(cart_speed.universe, [input1[3][0],input1[3][1],input1[3][2],input1[3][3]])
    cart_speed['4'] = fuzz.trapmf(cart_speed.universe, [input1[4][0],input1[4][1],input1[4][2],input1[4][3]])
    cart_speed['7'] = fuzz.trapmf(cart_speed.universe, [input1[5][0],input1[5][1],input1[5][2],input1[5][3]])
    cart_speed['8'] = fuzz.trapmf(cart_speed.universe, [input1[6][0],input1[6][1],input1[6][2],input1[6][3]])
    cart_speed['10'] = fuzz.trapmf(cart_speed.universe, [input1[7][0],input1[7][1],input1[7][2],input1[7][3]])
    cart_speed['11'] = fuzz.trapmf(cart_speed.universe, [input1[8][0],input1[8][1],input1[8][2],input1[8][3]])
    cart_speed['12'] = fuzz.trapmf(cart_speed.universe, [input1[9][0],input1[9][1],input1[9][2],input1[9][3]])
    cart_speed['13'] = fuzz.trapmf(cart_speed.universe, [input1[10][0],input1[10][1],input1[10][2],input1[10][3]])
    cart_speed['14'] = fuzz.trapmf(cart_speed.universe, [input1[11][0],input1[11][1],input1[11][2],input1[11][3]])
    cart_speed['15'] = fuzz.trapmf(cart_speed.universe, [input1[12][0],input1[12][1],input1[12][2],input1[12][3]])
    cart_speed['16'] = fuzz.trapmf(cart_speed.universe, [input1[13][0],input1[13][1],input1[13][2],input1[13][3]])
    cart_speed['18'] = fuzz.trapmf(cart_speed.universe, [input1[14][0],input1[14][1],input1[14][2],input1[14][3]])
    cart_speed['19'] = fuzz.trapmf(cart_speed.universe, [input1[15][0],input1[15][1],input1[15][2],input1[15][3]])
    cart_speed['20'] = fuzz.trapmf(cart_speed.universe, [input1[16][0],input1[16][1],input1[16][2],input1[16][3]])
    cart_speed['22'] = fuzz.trapmf(cart_speed.universe, [input1[17][0],input1[17][1],input1[17][2],input1[17][3]])
    cart_speed['23'] = fuzz.trapmf(cart_speed.universe, [input1[18][0],input1[18][1],input1[18][2],input1[18][3]])
    cart_speed['24'] = fuzz.trapmf(cart_speed.universe, [input1[19][0],input1[19][1],input1[19][2],input1[19][3]])
    cart_speed['26'] = fuzz.trapmf(cart_speed.universe, [input1[20][0],input1[20][1],input1[20][2],input1[20][3]])
    cart_speed['27'] = fuzz.trapmf(cart_speed.universe, [input1[21][0],input1[21][1],input1[21][2],input1[21][3]])
    cart_speed['28'] = fuzz.trapmf(cart_speed.universe, [input1[22][0],input1[22][1],input1[22][2],input1[22][3]])
    cart_speed['29'] = fuzz.trapmf(cart_speed.universe, [input1[23][0],input1[23][1],input1[23][2],input1[23][3]])
    cart_speed['30'] = fuzz.trapmf(cart_speed.universe, [input1[24][0],input1[24][1],input1[24][2],input1[24][3]])
    cart_speed['31'] = fuzz.trapmf(cart_speed.universe, [input1[25][0],input1[25][1],input1[25][2],input1[25][3]])
    cart_speed['32'] = fuzz.trapmf(cart_speed.universe, [input1[26][0],input1[26][1],input1[26][2],input1[26][3]])
    cart_speed['33'] = fuzz.trapmf(cart_speed.universe, [input1[27][0],input1[27][1],input1[27][2],input1[27][3]])
    cart_speed['34'] = fuzz.trapmf(cart_speed.universe, [input1[28][0],input1[28][1],input1[28][2],input1[28][3]])
    cart_speed['35'] = fuzz.trapmf(cart_speed.universe, [input1[29][0],input1[29][1],input1[29][2],input1[29][3]])
    cart_speed['36'] = fuzz.trapmf(cart_speed.universe, [input1[30][0],input1[30][1],input1[30][2],input1[30][3]])
    cart_speed['37'] = fuzz.trapmf(cart_speed.universe, [input1[31][0],input1[31][1],input1[31][2],input1[31][3]])
    cart_speed['38'] = fuzz.trapmf(cart_speed.universe, [input1[32][0],input1[32][1],input1[32][2],input1[32][3]])
    cart_speed['39'] = fuzz.trapmf(cart_speed.universe, [input1[33][0],input1[33][1],input1[33][2],input1[33][3]])
    cart_speed['40'] = fuzz.trapmf(cart_speed.universe, [input1[34][0],input1[34][1],input1[34][2],input1[34][3]])

    #入力2のメンバーシップ関数
    pole_angular_velocity['0'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[0][0],input2[0][1],input2[0][2],input2[0][3]])
    pole_angular_velocity['1'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[1][0],input2[1][1],input2[1][2],input2[1][3]])
    pole_angular_velocity['2'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[2][0],input2[2][1],input2[2][2],input2[2][3]])
    pole_angular_velocity['3'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[3][0],input2[3][1],input2[3][2],input2[3][3]])
    pole_angular_velocity['4'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[4][0],input2[4][1],input2[4][2],input2[4][3]])
    pole_angular_velocity['7'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[5][0],input2[5][1],input2[5][2],input2[5][3]])
    pole_angular_velocity['8'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[6][0],input2[6][1],input2[6][2],input2[6][3]])
    pole_angular_velocity['10'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[7][0],input2[7][1],input2[7][2],input2[7][3]])
    pole_angular_velocity['11'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[8][0],input2[8][1],input2[8][2],input2[8][3]])
    pole_angular_velocity['12'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[9][0],input2[9][1],input2[9][2],input2[9][3]])
    pole_angular_velocity['13'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[10][0],input2[10][1],input2[10][2],input2[10][3]])
    pole_angular_velocity['14'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[11][0],input2[11][1],input2[11][2],input2[11][3]])
    pole_angular_velocity['15'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[12][0],input2[12][1],input2[12][2],input2[12][3]])
    pole_angular_velocity['16'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[13][0],input2[13][1],input2[13][2],input2[13][3]])
    pole_angular_velocity['18'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[14][0],input2[14][1],input2[14][2],input2[14][3]])
    pole_angular_velocity['19'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[15][0],input2[15][1],input2[15][2],input2[15][3]])
    pole_angular_velocity['20'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[16][0],input2[16][1],input2[16][2],input2[16][3]])
    pole_angular_velocity['22'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[17][0],input2[17][1],input2[17][2],input2[17][3]])
    pole_angular_velocity['23'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[18][0],input2[18][1],input2[18][2],input2[18][3]])
    pole_angular_velocity['24'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[19][0],input2[19][1],input2[19][2],input2[19][3]])
    pole_angular_velocity['26'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[20][0],input2[20][1],input2[20][2],input2[20][3]])
    pole_angular_velocity['27'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[21][0],input2[21][1],input2[21][2],input2[21][3]])
    pole_angular_velocity['28'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[22][0],input2[22][1],input2[22][2],input2[22][3]])
    pole_angular_velocity['29'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[23][0],input2[23][1],input2[23][2],input2[23][3]])
    pole_angular_velocity['30'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[24][0],input2[24][1],input2[24][2],input2[24][3]])
    pole_angular_velocity['31'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[25][0],input2[25][1],input2[25][2],input2[25][3]])
    pole_angular_velocity['32'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[26][0],input2[26][1],input2[26][2],input2[26][3]])
    pole_angular_velocity['33'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[27][0],input2[27][1],input2[27][2],input2[27][3]])
    pole_angular_velocity['34'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[28][0],input2[28][1],input2[28][2],input2[28][3]])
    pole_angular_velocity['35'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[29][0],input2[29][1],input2[29][2],input2[29][3]])
    pole_angular_velocity['36'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[30][0],input2[30][1],input2[30][2],input2[30][3]])
    pole_angular_velocity['37'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[31][0],input2[31][1],input2[31][2],input2[31][3]])
    pole_angular_velocity['38'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[32][0],input2[32][1],input2[32][2],input2[32][3]])
    pole_angular_velocity['39'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[33][0],input2[33][1],input2[33][2],input2[33][3]])
    pole_angular_velocity['40'] = fuzz.trapmf(pole_angular_velocity.universe, [input2[34][0],input2[34][1],input2[34][2],input2[34][3]])

    cart_position['0'] = fuzz.trapmf(cart_position.universe, [input3[0][0],input3[0][1],input3[0][2],input3[0][3]])
    cart_position['1'] = fuzz.trapmf(cart_position.universe, [input3[1][0],input3[1][1],input3[1][2],input3[1][3]])
    cart_position['2'] = fuzz.trapmf(cart_position.universe, [input3[2][0],input3[2][1],input3[2][2],input3[2][3]])
    cart_position['3'] = fuzz.trapmf(cart_position.universe, [input3[3][0],input3[3][1],input3[3][2],input3[3][3]])
    cart_position['4'] = fuzz.trapmf(cart_position.universe, [input3[4][0],input3[4][1],input3[4][2],input3[4][3]])
    cart_position['7'] = fuzz.trapmf(cart_position.universe, [input3[5][0],input3[5][1],input3[5][2],input3[5][3]])
    cart_position['8'] = fuzz.trapmf(cart_position.universe, [input3[6][0],input3[6][1],input3[6][2],input3[6][3]])
    cart_position['10'] = fuzz.trapmf(cart_position.universe, [input3[7][0],input3[7][1],input3[7][2],input3[7][3]])
    cart_position['11'] = fuzz.trapmf(cart_position.universe, [input3[8][0],input3[8][1],input3[8][2],input3[8][3]])
    cart_position['12'] = fuzz.trapmf(cart_position.universe, [input3[9][0],input3[9][1],input3[9][2],input3[9][3]])
    cart_position['13'] = fuzz.trapmf(cart_position.universe, [input3[10][0],input3[10][1],input3[10][2],input3[10][3]])
    cart_position['14'] = fuzz.trapmf(cart_position.universe, [input3[11][0],input3[11][1],input3[11][2],input3[11][3]])
    cart_position['15'] = fuzz.trapmf(cart_position.universe, [input3[12][0],input3[12][1],input3[12][2],input3[12][3]])
    cart_position['16'] = fuzz.trapmf(cart_position.universe, [input3[13][0],input3[13][1],input3[13][2],input3[13][3]])
    cart_position['18'] = fuzz.trapmf(cart_position.universe, [input3[14][0],input3[14][1],input3[14][2],input3[14][3]])
    cart_position['19'] = fuzz.trapmf(cart_position.universe, [input3[15][0],input3[15][1],input3[15][2],input3[15][3]])
    cart_position['20'] = fuzz.trapmf(cart_position.universe, [input3[16][0],input3[16][1],input3[16][2],input3[16][3]])
    cart_position['22'] = fuzz.trapmf(cart_position.universe, [input3[17][0],input3[17][1],input3[17][2],input3[17][3]])
    cart_position['23'] = fuzz.trapmf(cart_position.universe, [input3[18][0],input3[18][1],input3[18][2],input3[18][3]])
    cart_position['24'] = fuzz.trapmf(cart_position.universe, [input3[19][0],input3[19][1],input3[19][2],input3[19][3]])
    cart_position['26'] = fuzz.trapmf(cart_position.universe, [input3[20][0],input3[20][1],input3[20][2],input3[20][3]])
    cart_position['27'] = fuzz.trapmf(cart_position.universe, [input3[21][0],input3[21][1],input3[21][2],input3[21][3]])
    cart_position['28'] = fuzz.trapmf(cart_position.universe, [input3[22][0],input3[22][1],input3[22][2],input3[22][3]])
    cart_position['29'] = fuzz.trapmf(cart_position.universe, [input3[23][0],input3[23][1],input3[23][2],input3[23][3]])
    cart_position['30'] = fuzz.trapmf(cart_position.universe, [input3[24][0],input3[24][1],input3[24][2],input3[24][3]])
    cart_position['31'] = fuzz.trapmf(cart_position.universe, [input3[25][0],input3[25][1],input3[25][2],input3[25][3]])
    cart_position['32'] = fuzz.trapmf(cart_position.universe, [input3[26][0],input3[26][1],input3[26][2],input3[26][3]])
    cart_position['33'] = fuzz.trapmf(cart_position.universe, [input3[27][0],input3[27][1],input3[27][2],input3[27][3]])
    cart_position['34'] = fuzz.trapmf(cart_position.universe, [input3[28][0],input3[28][1],input3[28][2],input3[28][3]])
    cart_position['35'] = fuzz.trapmf(cart_position.universe, [input3[29][0],input3[29][1],input3[29][2],input3[29][3]])
    cart_position['36'] = fuzz.trapmf(cart_position.universe, [input3[30][0],input3[30][1],input3[30][2],input3[30][3]])
    cart_position['37'] = fuzz.trapmf(cart_position.universe, [input3[31][0],input3[31][1],input3[31][2],input3[31][3]])
    cart_position['38'] = fuzz.trapmf(cart_position.universe, [input3[32][0],input3[32][1],input3[32][2],input3[32][3]])
    cart_position['39'] = fuzz.trapmf(cart_position.universe, [input3[33][0],input3[33][1],input3[33][2],input3[33][3]])
    cart_position['40'] = fuzz.trapmf(cart_position.universe, [input3[34][0],input3[34][1],input3[34][2],input3[34][3]])

    pole_angule['0'] = fuzz.trapmf(pole_angule.universe, [input4[0][0],input4[0][1],input4[0][2],input4[0][3]])
    pole_angule['1'] = fuzz.trapmf(pole_angule.universe, [input4[1][0],input4[1][1],input4[1][2],input4[1][3]])
    pole_angule['2'] = fuzz.trapmf(pole_angule.universe, [input4[2][0],input4[2][1],input4[2][2],input4[2][3]])
    pole_angule['3'] = fuzz.trapmf(pole_angule.universe, [input4[3][0],input4[3][1],input4[3][2],input4[3][3]])
    pole_angule['4'] = fuzz.trapmf(pole_angule.universe, [input4[4][0],input4[4][1],input4[4][2],input4[4][3]])
    pole_angule['7'] = fuzz.trapmf(pole_angule.universe, [input4[5][0],input4[5][1],input4[5][2],input4[5][3]])
    pole_angule['8'] = fuzz.trapmf(pole_angule.universe, [input4[6][0],input4[6][1],input4[6][2],input4[6][3]])
    pole_angule['10'] = fuzz.trapmf(pole_angule.universe, [input4[7][0],input4[7][1],input4[7][2],input4[7][3]])
    pole_angule['11'] = fuzz.trapmf(pole_angule.universe, [input4[8][0],input4[8][1],input4[8][2],input4[8][3]])
    pole_angule['12'] = fuzz.trapmf(pole_angule.universe, [input4[9][0],input4[9][1],input4[9][2],input4[9][3]])
    pole_angule['13'] = fuzz.trapmf(pole_angule.universe, [input4[10][0],input4[10][1],input4[10][2],input4[10][3]])
    pole_angule['14'] = fuzz.trapmf(pole_angule.universe, [input4[11][0],input4[11][1],input4[11][2],input4[11][3]])
    pole_angule['15'] = fuzz.trapmf(pole_angule.universe, [input4[12][0],input4[12][1],input4[12][2],input4[12][3]])
    pole_angule['16'] = fuzz.trapmf(pole_angule.universe, [input4[13][0],input4[13][1],input4[13][2],input4[13][3]])
    pole_angule['18'] = fuzz.trapmf(pole_angule.universe, [input4[14][0],input4[14][1],input4[14][2],input4[14][3]])
    pole_angule['19'] = fuzz.trapmf(pole_angule.universe, [input4[15][0],input4[15][1],input4[15][2],input4[15][3]])
    pole_angule['20'] = fuzz.trapmf(pole_angule.universe, [input4[16][0],input4[
16][1],input4[16][2],input4[16][3]])
    pole_angule['22'] = fuzz.trapmf(pole_angule.universe, [input4[17][0],input4[
17][1],input4[17][2],input4[17][3]])
    pole_angule['23'] = fuzz.trapmf(pole_angule.universe, [input4[18][0],input4[
18][1],input4[18][2],input4[18][3]])
    pole_angule['24'] = fuzz.trapmf(pole_angule.universe, [input4[19][0],input4[19][1],input4[19][2],input4[19][3]])
    pole_angule['26'] = fuzz.trapmf(pole_angule.universe, [input4[20][0],input4[20][1],input4[20][2],input4[20][3]])
    pole_angule['27'] = fuzz.trapmf(pole_angule.universe, [input4[21][0],input4[21][1],input4[21][2],input4[21][3]])
    pole_angule['28'] = fuzz.trapmf(pole_angule.universe, [input4[22][0],input4[22][1],input4[22][2],input4[22][3]])
    pole_angule['29'] = fuzz.trapmf(pole_angule.universe, [input4[23][0],input4[23][1],input4[23][2],input4[23][3]])
    pole_angule['30'] = fuzz.trapmf(pole_angule.universe, [input4[24][0],input4[24][1],input4[24][2],input4[24][3]])
    pole_angule['31'] = fuzz.trapmf(pole_angule.universe, [input4[25][0],input4[25][1],input4[25][2],input4[25][3]])
    pole_angule['32'] = fuzz.trapmf(pole_angule.universe, [input4[26][0],input4[26][1],input4[26][2],input4[26][3]])
    pole_angule['33'] = fuzz.trapmf(pole_angule.universe, [input4[27][0],input4[27][1],input4[27][2],input4[27][3]])
    pole_angule['34'] = fuzz.trapmf(pole_angule.universe, [input4[28][0],input4[28][1],input4[28][2],input4[28][3]])
    pole_angule['35'] = fuzz.trapmf(pole_angule.universe, [input4[29][0],input4[29][1],input4[29][2],input4[29][3]])
    pole_angule['36'] = fuzz.trapmf(pole_angule.universe, [input4[30][0],input4[30][1],input4[30][2],input4[30][3]])
    pole_angule['37'] = fuzz.trapmf(pole_angule.universe, [input4[31][0],input4[31][1],input4[31][2],input4[31][3]])
    pole_angule['38'] = fuzz.trapmf(pole_angule.universe, [input4[32][0],input4[32][1],input4[32][2],input4[32][3]])
    pole_angule['39'] = fuzz.trapmf(pole_angule.universe, [input4[33][0],input4[33][1],input4[33][2],input4[33][3]])
    pole_angule['40'] = fuzz.trapmf(pole_angule.universe, [input4[34][0],input4[34][1],input4[34][2],input4[34][3]])

    #出力のメンバーシップ関数
    action['0'] = fuzz.trimf(action.universe, [0, 0, 1])
    action['1'] = fuzz.trimf(action.universe, [0, 1, 2])
    action['2'] = fuzz.trimf(action.universe, [1, 2, 3])
    action['3'] = fuzz.trimf(action.universe, [2, 3, 4])
    action['4'] = fuzz.trimf(action.universe, [3, 4, 5])
    action['5'] = fuzz.trimf(action.universe, [4, 5, 6])
    action['6'] = fuzz.trimf(action.universe, [5, 6, 7])
    action['7'] = fuzz.trimf(action.universe, [6, 7, 8])
    action['8'] = fuzz.trimf(action.universe, [7, 8, 9])
    action['9'] = fuzz.trimf(action.universe, [8, 9, 10])
    action['10'] = fuzz.trimf(action.universe, [9, 10, 11])
    action['11'] = fuzz.trimf(action.universe, [10, 11, 12])
    action['12'] = fuzz.trimf(action.universe, [11, 12, 13])
    action['13'] = fuzz.trimf(action.universe, [12, 13, 14])
    action['14'] = fuzz.trimf(action.universe, [13, 14, 15])
    action['15'] = fuzz.trimf(action.universe, [14, 15, 16])
    action['16'] = fuzz.trimf(action.universe, [15, 16, 17])
    action['17'] = fuzz.trimf(action.universe, [16, 17, 18])
    action['18'] = fuzz.trimf(action.universe, [17, 18, 19])
    action['19'] = fuzz.trimf(action.universe, [18, 19, 20])
    action['20'] = fuzz.trimf(action.universe, [19, 20, 21])
    action['21'] = fuzz.trimf(action.universe, [20, 21, 22])
    action['22'] = fuzz.trimf(action.universe, [21, 22, 23])
    action['23'] = fuzz.trimf(action.universe, [22, 23, 24])
    action['24'] = fuzz.trimf(action.universe, [23, 24, 25])
    action['25'] = fuzz.trimf(action.universe, [24, 25, 26])
    action['26'] = fuzz.trimf(action.universe, [25, 26, 27])
    action['27'] = fuzz.trimf(action.universe, [26, 27, 28])
    action['28'] = fuzz.trimf(action.universe, [27, 28, 29])
    action['29'] = fuzz.trimf(action.universe, [28, 29, 30])
    action['30'] = fuzz.trimf(action.universe, [29, 30, 31])
    action['31'] = fuzz.trimf(action.universe, [30, 31, 32])
    action['32'] = fuzz.trimf(action.universe, [31, 32, 33])
    action['33'] = fuzz.trimf(action.universe, [32, 33, 34])
    action['34'] = fuzz.trimf(action.universe, [33, 34, 35])
    action['35'] = fuzz.trimf(action.universe, [34, 35, 36])
    action['36'] = fuzz.trimf(action.universe, [35, 36, 37])
    action['37'] = fuzz.trimf(action.universe, [36, 37, 38])
    action['38'] = fuzz.trimf(action.universe, [37, 38, 39])
    action['39'] = fuzz.trimf(action.universe, [38, 39, 40])
    action['40'] = fuzz.trimf(action.universe, [39, 40, 40])

    #ルール
    rule0 = ctrl.Rule(cart_speed["0"] & pole_angular_velocity["0"] & cart_position["0"] & pole_angule["0"], action["0"])
    rule1 = ctrl.Rule(cart_speed["1"] & pole_angular_velocity["1"] & cart_position["1"] & pole_angule["1"], action["1"])
    rule2 = ctrl.Rule(cart_speed["2"] & pole_angular_velocity["2"] & cart_position["2"] & pole_angule["2"], action["2"])
    rule3 = ctrl.Rule(cart_speed["3"] & pole_angular_velocity["3"] & cart_position["3"] & pole_angule["3"], action["3"])
    rule4 = ctrl.Rule(cart_speed["4"] & pole_angular_velocity["4"] & cart_position["4"] & pole_angule["4"], action["4"])
    rule7 = ctrl.Rule(cart_speed["7"] & pole_angular_velocity["7"] & cart_position["7"] & pole_angule["7"], action["7"])
    rule8 = ctrl.Rule(cart_speed["8"] & pole_angular_velocity["8"] & cart_position["8"] & pole_angule["8"], action["8"])
    rule10 = ctrl.Rule(cart_speed["10"] & pole_angular_velocity["10"] & cart_position["10"] & pole_angule["10"], action["10"])
    rule11 = ctrl.Rule(cart_speed["11"] & pole_angular_velocity["11"] & cart_position["11"] & pole_angule["11"], action["11"])
    rule12 = ctrl.Rule(cart_speed["12"] & pole_angular_velocity["12"] & cart_position["12"] & pole_angule["12"], action["12"])
    rule13 = ctrl.Rule(cart_speed["13"] & pole_angular_velocity["13"] & cart_position["13"] & pole_angule["13"], action["13"])
    rule14 = ctrl.Rule(cart_speed["14"] & pole_angular_velocity["14"] & cart_position["14"] & pole_angule["14"], action["14"])
    rule15 = ctrl.Rule(cart_speed["15"] & pole_angular_velocity["15"] & cart_position["15"] & pole_angule["15"], action["15"])
    rule16 = ctrl.Rule(cart_speed["16"] & pole_angular_velocity["16"] & cart_position["16"] & pole_angule["16"], action["16"])
    rule18 = ctrl.Rule(cart_speed["18"] & pole_angular_velocity["18"] & cart_position["18"] & pole_angule["18"], action["18"])
    rule19 = ctrl.Rule(cart_speed["19"] & pole_angular_velocity["19"] & cart_position["19"] & pole_angule["19"], action["19"])
    rule20 = ctrl.Rule(cart_speed["20"] & pole_angular_velocity["20"] & cart_position["20"] & pole_angule["20"], action["20"])
    rule22 = ctrl.Rule(cart_speed["22"] & pole_angular_velocity["22"] & cart_position["22"] & pole_angule["22"], action["22"])
    rule23 = ctrl.Rule(cart_speed["23"] & pole_angular_velocity["23"] & cart_position["23"] & pole_angule["23"], action["23"])
    rule24 = ctrl.Rule(cart_speed["24"] & pole_angular_velocity["24"] & cart_position["24"] & pole_angule["24"], action["24"])
    rule26 = ctrl.Rule(cart_speed["26"] & pole_angular_velocity["26"] & cart_position["26"] & pole_angule["26"], action["26"])
    rule27 = ctrl.Rule(cart_speed["27"] & pole_angular_velocity["27"] & cart_position["27"] & pole_angule["27"], action["27"])
    rule28 = ctrl.Rule(cart_speed["28"] & pole_angular_velocity["28"] & cart_position["28"] & pole_angule["28"], action["28"])
    rule29 = ctrl.Rule(cart_speed["29"] & pole_angular_velocity["29"] & cart_position["29"] & pole_angule["29"], action["29"])
    rule30 = ctrl.Rule(cart_speed["30"] & pole_angular_velocity["30"] & cart_position["30"] & pole_angule["30"], action["30"])
    rule31 = ctrl.Rule(cart_speed["31"] & pole_angular_velocity["31"] & cart_position["31"] & pole_angule["31"], action["31"])
    rule32 = ctrl.Rule(cart_speed["32"] & pole_angular_velocity["32"] & cart_position["32"] & pole_angule["32"], action["32"])
    rule33 = ctrl.Rule(cart_speed["33"] & pole_angular_velocity["33"] & cart_position["33"] & pole_angule["33"], action["33"])
    rule34 = ctrl.Rule(cart_speed["34"] & pole_angular_velocity["34"] & cart_position["34"] & pole_angule["34"], action["34"])
    rule35 = ctrl.Rule(cart_speed["35"] & pole_angular_velocity["35"] & cart_position["35"] & pole_angule["35"], action["35"])
    rule36 = ctrl.Rule(cart_speed["36"] & pole_angular_velocity["36"] & cart_position["36"] & pole_angule["36"], action["36"])
    rule37 = ctrl.Rule(cart_speed["37"] & pole_angular_velocity["37"] & cart_position["37"] & pole_angule["37"], action["37"])
    rule38 = ctrl.Rule(cart_speed["38"] & pole_angular_velocity["38"] & cart_position["38"] & pole_angule["38"], action["38"])
    rule39 = ctrl.Rule(cart_speed["39"] & pole_angular_velocity["39"] & cart_position["39"] & pole_angule["39"], action["39"])
    rule40 = ctrl.Rule(cart_speed["40"] & pole_angular_velocity["40"] & cart_position["40"] & pole_angule["40"], action["40"])

    cartpole_ctrl = ctrl.ControlSystem([rule0,rule1,rule2,rule3,rule4,rule7,rule8,rule10,rule11,rule12,rule13,rule14,rule15,rule16,rule18,rule19,rule20,rule22,rule23,rule24,rule26,rule27,rule28,rule29,rule30,rule31,rule32,rule33,rule34,rule35,rule36,rule37,rule38,rule39,rule40])
    cartpole = ctrl.ControlSystemSimulation(cartpole_ctrl)

    for i in range(len(c_s)):
        #print(i)
        cartpole.input['cart_speed'] = c_s[i]
        cartpole.input["pole_angular_velocity"] = p_an[i]
        cartpole.input['cart_position'] = c_p[i]
        cartpole.input["pole_angule"] = p_a[i]
        try:
            cartpole.compute()
        except Exception:
            ac = 100
        else:
            ac = int((Decimal(cartpole.output["action"]).quantize(Decimal('0'), rounding=ROUND_HALF_UP)))

        action_num.append(ac)

    return action_num
